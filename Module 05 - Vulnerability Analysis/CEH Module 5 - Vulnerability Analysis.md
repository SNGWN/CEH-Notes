# Vulnerability Assessment/Research
	Vulnerability Assessment is a process of examination, discovery, and identification of a system and applications security measures and weakness. It helps to recognize the vulnerabilities that could be exploited, need of additional security layers, and information that can be revealed using scanners.  
--------------------------------
# Vulnerability Assessment Life-Cycle
	- Discover: Discover Vulnerability
	- Priotize : Priotize Vulnerability as per its target, impact, loss value, Bussiness Impact, etc.
	- Report : Prepare a report on Vulnerability.
	- Remediate : Take appropriate perventive actions.
	- Verify : Verfiy that vulnerability is resolved or not.
	- Monitor : Monitor the network traffic and system behaviors for any further intrusion.
--------------------------------------------------------------------------------------------------
# Vulnerability Scoring System - CVSS (Critical Vulnerability Scoring System) -> CVE-CWE
	- Common Vulnerability Scoring System (CVSS v2.0)
		- Low: 0.0 - 3.9
		- Medium: 4.0 - 6.9
		- High: 7.0 - 10.0

	- Common Vulnerability Scoring System (CVSS v3.0)
		- None: 0.0 - INFO   
		- Low: 0.1 - 3.9
		- Medium: 4.0 - 6.9
		- High: 7.0 - 8.9
		- Critical: 9.0 - 10.0
--------------------------------------------------------------------------------------------------
# Common Vulnerabilities and Exposures (CVE) - Whenever a Vulnerability is exposed globally it is distinguished by it CVE number.
	- Platforms to find information about vulnerabilities
		- https://nvd.nist.gov/
		- https://cve.mitre.org/
		- https://exploit-db.com/
--------------------------------------------------------------------------------------------------
# Vulnerability Scanners
	Vulnerability Scanners are automated utilities to detect vulnerabilities. They are capable of :-
		- OS Detection and Version Detection
		- Applications Installed
		- Accounts with Weak Passwords
		- Missing Patches
		- Weak/Misconfigured Network and Risky Ports
	These scanning tools perform deep inspection of scripts, open ports, banners, running services, configuration errors, etc...

# Top scanners:
	- Nmap Scripts - Vuln, discovery, safe, etc
	- Nikto
	- wpscan
	- Acunetix
	- Nessus
	- Qualys Free Scan
	- Crashtest - https://crashtest.cloud/login
--------------------------------------------------------------------------------------------------

# Practical Vulnerability Scanning Payloads and Techniques

## Nmap NSE Vulnerability Scripts
```bash
# Comprehensive Vulnerability Scanning
nmap --script vuln target                                  # All vulnerability scripts
nmap --script vuln,safe target                           # Safe vulnerability scripts only
nmap --script "vuln and not intrusive" target            # Non-intrusive vuln scripts

# Specific Vulnerability Categories
nmap --script smb-vuln-* target                          # SMB vulnerabilities (EternalBlue, etc.)
nmap --script ssl-* target                               # SSL/TLS vulnerabilities
nmap --script http-vuln-* target                         # Web application vulnerabilities
nmap --script ftp-vuln-* target                          # FTP vulnerabilities

# Critical Vulnerability Detection
nmap --script smb-vuln-ms17-010 target                   # EternalBlue detection
nmap --script ssl-heartbleed target                      # Heartbleed detection
nmap --script http-shellshock target                     # Shellshock detection
nmap --script ssl-poodle target                          # POODLE SSL vulnerability
```

**Documentation**: Automated vulnerability detection using Nmap's extensive script database.
**Limitations**: Scripts may produce false positives; some vulnerabilities require manual verification.

## Web Application Vulnerability Scanning

### Nikto - Web Server Scanner
```bash
# Basic Nikto Scanning
nikto -h http://target                                    # Basic web server scan
nikto -h http://target -port 80,443,8080,8443           # Multiple ports
nikto -h http://target -ssl                              # Force SSL scanning
nikto -h http://target -Format htm -output report.html   # HTML report output

# Advanced Nikto Options
nikto -h http://target -Tuning 123456789a                # All scan types
nikto -h http://target -evasion 12345678                 # Evasion techniques
nikto -h http://target -Plugins "@@DEFAULT"              # Default plugins
```

**Documentation**: Comprehensive web server vulnerability scanner checking for outdated software, dangerous files, and server misconfigurations.
**Limitations**: Generates significant web traffic; may trigger WAF alerts; can produce false positives.

### WordPress Security Scanning (WPScan)
```bash
# WordPress Vulnerability Assessment
wpscan --url http://target                                # Basic WordPress scan
wpscan --url http://target --enumerate u                 # Enumerate users
wpscan --url http://target --enumerate p                 # Enumerate plugins
wpscan --url http://target --enumerate t                 # Enumerate themes
wpscan --url http://target --enumerate vp,vt,u          # Vulnerable plugins, themes, users

# WordPress Brute Force
wpscan --url http://target --usernames admin,administrator --passwords /usr/share/wordlists/rockyou.txt
wpscan --url http://target --users-list users.txt --passwords passwords.txt

# API Token Usage (for updated vulnerability database)
wpscan --url http://target --api-token YOUR_API_TOKEN    # Enhanced vulnerability detection
```

**Documentation**: Specialized WordPress security scanner for themes, plugins, and core vulnerabilities.
**Limitations**: Requires WordPress target; API token needed for full vulnerability database; may be detected by security plugins.

## Network Service Vulnerability Assessment

### SMB Vulnerability Testing
```bash
# SMB Protocol Analysis
enum4linux target                                        # SMB enumeration tool
smbclient -L //target/ -N                               # List SMB shares
smbmap -H target                                         # SMB share mapper

# EternalBlue (MS17-010) Testing
python ms17-010_scanner.py target                        # Custom EternalBlue scanner
nmap --script smb-vuln-ms17-010 target                  # Nmap EternalBlue detection
use auxiliary/scanner/smb/smb_ms17_010                   # Metasploit module

# SMB Brute Force
hydra -L users.txt -P passwords.txt target smb           # SMB credential brute force
medusa -h target -U users.txt -P passwords.txt -M smbnt # Alternative SMB brute force
```

**Documentation**: SMB service vulnerability assessment including critical vulnerabilities like EternalBlue.
**Limitations**: Some tests may cause service disruption; requires proper network access; modern systems may have patches.

### SSH Vulnerability Assessment
```bash
# SSH Security Testing
ssh-audit target                                          # SSH configuration audit
nmap --script ssh2-enum-algos target                     # SSH algorithm enumeration
nmap --script ssh-hostkey target                         # SSH host key information

# SSH Brute Force
hydra -L users.txt -P passwords.txt target ssh           # SSH credential brute force
medusa -h target -U users.txt -P passwords.txt -M ssh    # Alternative SSH brute force
patator ssh_login host=target user=FILE0 password=FILE1 0=users.txt 1=passwords.txt

# SSH Vulnerability Checks
nmap --script ssh-vuln-cve2018-15473 target             # SSH username enumeration
```

**Documentation**: SSH service security assessment including configuration review and credential testing.
**Limitations**: Brute force may lock accounts; modern SSH implementations have rate limiting; generates significant logs.

## Database Vulnerability Scanning

### MySQL/MariaDB Assessment
```bash
# MySQL Security Testing
nmap --script mysql-* target                             # All MySQL scripts
nmap --script mysql-vuln-cve2012-2122 target           # MySQL authentication bypass
mysql -h target -u root -p                              # Direct MySQL connection

# MySQL Brute Force
hydra -L users.txt -P passwords.txt target mysql         # MySQL credential brute force
nmap --script mysql-brute target                        # Nmap MySQL brute force

# MySQL Information Gathering
nmap --script mysql-info target                         # MySQL server information
nmap --script mysql-databases --script-args mysqluser=root,mysqlpass=pass target
```

**Documentation**: MySQL database security assessment including authentication and configuration vulnerabilities.
**Limitations**: Database attacks may be logged; requires network access to database port; may trigger account lockouts.

### MongoDB Assessment
```bash
# MongoDB Security Testing
nmap --script mongodb-* target                           # All MongoDB scripts
nmap --script mongodb-info target                       # MongoDB server information
mongo target:27017                                      # Direct MongoDB connection

# MongoDB Brute Force and Enumeration
nmap --script mongodb-brute target                      # MongoDB authentication brute force
nmap --script mongodb-databases target                  # Database enumeration
```

**Documentation**: MongoDB database security assessment for authentication and authorization vulnerabilities.
**Limitations**: Modern MongoDB versions require authentication; may generate significant database logs.

## Automated Vulnerability Assessment Tools

### OpenVAS Scanner Setup and Usage
```bash
# OpenVAS Setup (requires installation)
sudo openvas-setup                                       # Initial OpenVAS setup
sudo openvas-start                                       # Start OpenVAS services
sudo openvas-check-setup                                 # Verify installation

# OpenVAS Command Line Interface
omp --username admin --password admin --get-tasks        # List scanning tasks
omp --username admin --password admin --create-task "Scan Task" --target target
```

**Documentation**: Enterprise-grade vulnerability scanner with comprehensive vulnerability database.
**Limitations**: Resource-intensive; requires significant setup; may produce many false positives.

### Custom Vulnerability Assessment Script
```bash
#!/bin/bash
# vuln_assessment.sh - Comprehensive vulnerability assessment

TARGET=$1
LOGDIR="vuln_scan_$(date +%Y%m%d_%H%M%S)"
mkdir -p $LOGDIR

echo "[+] Starting comprehensive vulnerability assessment for $TARGET"

# Nmap vulnerability scan
echo "[+] Running Nmap vulnerability scripts..."
nmap --script vuln $TARGET > $LOGDIR/nmap_vuln.txt

# Nikto web scan
echo "[+] Running Nikto web vulnerability scan..."
nikto -h http://$TARGET > $LOGDIR/nikto_scan.txt 2>/dev/null

# SMB vulnerability check
echo "[+] Checking SMB vulnerabilities..."
nmap --script smb-vuln-* $TARGET > $LOGDIR/smb_vuln.txt

# SSL/TLS assessment
echo "[+] Assessing SSL/TLS configuration..."
nmap --script ssl-* $TARGET > $LOGDIR/ssl_assessment.txt

# Generate summary report
echo "[+] Generating summary report..."
echo "Vulnerability Assessment Report for $TARGET" > $LOGDIR/summary.txt
echo "Generated on: $(date)" >> $LOGDIR/summary.txt
echo "=============================================" >> $LOGDIR/summary.txt

echo "[+] Assessment complete. Results saved in $LOGDIR/"
```

**Documentation**: Automated vulnerability assessment combining multiple tools for comprehensive security testing.
**Limitations**: May miss vulnerabilities requiring manual testing; can generate significant network traffic.

# CVSS Score Calculation and Risk Assessment

## Understanding CVSS Metrics
```
Base Score Metrics:
- Attack Vector (AV): Network/Adjacent/Local/Physical
- Attack Complexity (AC): Low/High
- Privileges Required (PR): None/Low/High
- User Interaction (UI): None/Required
- Scope (S): Unchanged/Changed
- Confidentiality (C): None/Low/High
- Integrity (I): None/Low/High
- Availability (A): None/Low/High

Example CVSS v3.1 Vector:
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (Score: 9.8 - Critical)
```

**Documentation**: CVSS provides standardized vulnerability severity scoring for prioritization.
**Limitations**: Temporal and environmental factors may affect actual risk; requires context-specific assessment.

# Reference URLs and Research Papers:
- NIST National Vulnerability Database: https://nvd.nist.gov/
- CVE Details Database: https://www.cvedetails.com/
- OWASP Vulnerability Scanning Guide: https://owasp.org/www-community/Vulnerability_Scanning_Tools
- SANS Vulnerability Assessment: https://www.sans.org/reading-room/whitepapers/testing/vulnerability-assessment-penetration-testing-36477
- Research Paper: "Automated Vulnerability Assessment" - https://ieeexplore.ieee.org/document/8976234
- CVSS Specification: https://www.first.org/cvss/specification-document
- NIST SP 800-40 Procedures for Handling Security Patches: https://csrc.nist.gov/publications/detail/sp/800-40/rev-3/final
- Vulnerability Assessment Framework: https://www.nist.gov/itl/applied-cybersecurity/nice/resources/vulnerability-assessment-framework
